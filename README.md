# Telegram-bot
Telegram-бот на Python для добавления в закрытый Telegram-канал пользователей, купивших курс на платформе GetCourse (с автоматическим исключением из канала по истечении срока подписки).

## Содержание
1. Описание проекта
   * Добавление пользователей
   * Удаление пользователей
   * Блок-схема
2. Создание Telegram-бота
3. Получение данных аккаунта GetCourse
4. Написание кода на Python

## 1. Описание проекта
### Добавление пользователей
1. Пользователь оплачивает курс, размещенный на платформе GetCourse
2. Ему на почту приходит письмо со ссылкой на Telegram-бот
3. При переходе в бот и нажатию /start бот предлагает ввести почту, по которой была совершена оплата
   * Предусмотрена валидация почты
4. Если формат почты верный, бот предлагает подождать некоторое время для проверки данных
5. Отправляется запрос по API геткурса для доступа к базе данных пользователей
   * Если введенный адрес найден, пользователю отправляется сообщение об успешной проверке и ссылка на закрытый Telegram-канал. Также создается словарь { почта: user_id } для мониторинга участников канала
   * Если введенный адрес не найден, пользователю отправляется сообщение с отказом в доступе

### Удаление пользователей 
1. Каждые 12 часов бот отправляет запрос по API геткурса для мониторинга даты истечения подписки
2. Проходимся циклом по значению поля даты истечения срока подписки
3. Если дата истечения подписки на сутки больше даты отправки запроса, то:
   * Обращаемся к словарю { почта: user_id } и находим user_id, который соответствует почте пользователя, у которого истекает подписка
   * Отправляем ему через бот уведомление 
   * Если по истечении суток пользователь не оплачивает продление подписки, бот удаляет его с канала
   * Если после удаления с канала пользователь оплатит подписку, он снова сможет отправить в бот почту для получения ссылки на канал
   
### Блок-схема
С блок-схемой процесса можно ознакомиться по [ссылке](https://www.figma.com/file/vk5goxBekCe76VYQknLBfa/Telegram-bot-Srorytellers?node-id=0%3A1&t=4GVCBki4ZLzEB6SD-1) в редакторе Figma.

## 2. Создание Telegram-бота
Если вы новичок в создании ботов, можно посмотреть [туториал](https://youtu.be/HodO2eBEz_8) с пошаговым объяснением всех этапов:
  * Создание бота через Telegram
  * Подключение python-кода к боту
  * Добавление и тестирование базового функционала 
